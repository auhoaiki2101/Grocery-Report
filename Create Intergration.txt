 CREATE OR REPLACE STORAGE INTEGRATION PBI_Integration
  TYPE = EXTERNAL_STAGE
  STORAGE_PROVIDER = 'S3'
  ENABLED = TRUE
  STORAGE_AWS_ROLE_ARN = 'arn:aws:iam::735825004881:role/powerbi.role'
  STORAGE_ALLOWED_LOCATIONS = ('s3://powerbi.project.s1/')
  COMMENT = 'Optional Comment'


  //description Integration Object
  desc integration PBI_Integration;

//drop integration PBI_Integration

--------------------------------------------
//drop database PowerBI

CREATE database PowerBI;

create schema PBI_Data;

create table PBI_Dataset (

Item_Fat_Content string,
Item_Identifier string,
Item_Type string,
Outlet_Establishment_Year int,
Outlet_Identifier string,
Outlet_Location_Type string,
Outlet_Size string,
Outlet_Type string,
Item_Vibility float,
item_Weight float,
Sales float,
Rating int

);

select * from PBI_Dataset;

//drop database test;

create stage PowerBI.PBI_Data.pbi_stage
url = 's3://powerbi.project.s1'
storage_integration = PBI_Integration

//desc stage s1

//drop stage s1;


copy into PBI_Dataset 
from @pbi_stage
file_format = (type=csv field_delimiter=',' skip_header=1 )
on_error = 'continue'

list @pbi_stage
